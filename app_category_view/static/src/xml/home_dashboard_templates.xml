<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
<!-- This template is used to display the home dashboard for app categories -->
    <t t-name="app_category_view.home_dashboard"
       t-inherit="web_enterprise.HomeMenu" t-inherit-mode="extension"
       owl="1">
        <!-- Replaces the existing apps container with the app categories and their corresponding apps -->
        <xpath expr="div[hasclass('o_home_menu')]/div[hasclass('container')]"
               position="replace">
            <input t-ref="input" type="text"
                   class="o_search_hidden visually-hidden w-auto"
                   data-allow-hotkeys="true" t-on-input="_onInputSearch"
                   t-on-blur="_onInputBlur"
                   t-on-compositionstart="_onCompositionStart"/>
            <!-- When the subscription has expired, the expiration panel is show over the whole UI instead of here -->
            <ExpirationPanel
                    t-if="subscription.warningType and !subscription.isWarningHidden and subscription.daysLeft &lt;= 30 and subscription.daysLeft > 0"/>
            <!-- Display all other apps that do not belong to any category -->
            <div t-if="displayedApps.length"
                 class="row accordion accordion-flush mt-5"
                 style="max-height: 100%;display: flex;flex-wrap: nowrap;align-items: start;"
                 id="accordion">
                <div class="category-apps">
                    <div class="apps-sortable-div collapsed active-category"
                         style="padding:1%;"
                         t-on-click="(ev) => this._active(ev)"
                         data-bs-toggle="collapse"
                         t-attf-data-bs-target="#otherApps" type="button"
                         t-att-aria-expanded="true"
                         t-att-aria-controls="otherApps"
                         t-on-dragover="(e)=>this.cancelDefault(e)"
                         t-on-drop="(e)=>this.dropped(e)">
                        <a class="col"
                           data-toggle="collapse">
                            <h1 style="position:relative;z-index:9999;color: white;"
                                name="OtherApps">All Apps
                            </h1>
                            <span class="arrow"/>
                        </a>
                    </div>
                    <t t-if="appCategory">
                        <t t-foreach="appCategory" t-as="category"
                           t-key="category.name">
                            <div class="apps-sortable-div collapsed"
                                 t-on-click="(ev) => this._active(ev)"
                                 data-bs-toggle="collapse"
                                 t-att-data-bs-target="'#'+category.name"
                                 role="button"
                                 t-att-aria-expanded="false"
                                 t-att-aria-controls="category.name"
                                 t-on-dragover="(e)=>this.cancelDefault(e)"
                                 t-on-drop="(e)=>this.dropped(e)"
                                 t-att-name="category.name">
                                <a class="col home_category_header">
                                    <h1 t-esc="category.name"
                                        t-att-name="category.name"
                                        style="position:relative;z-index:9999;color: white;"/>
                                </a>
                            </div>
                        </t>
                    </t>
                </div>
                <div style="width:55%;float:left;">
                    <div role="listbox"
                         class="o_apps row user-select-none accordion-collapse collapse show"
                         data-bs-parent="#accordion"
                         style="max-height:10%;"
                         id="otherApps">
                        <t t-foreach="displayedApps" t-as="app"
                           t-key="app.id">
                            <a t-att-id="app.id"
                               role="option"
                               style="display:flex;flex-wrap:inherit;justify-content:center;"
                               t-att-aria-selected="state.focusedIndex === app_index ? 'true' : 'false'"
                               class="o_app o_menuitem p-2 mb-3 col-lg-2"
                               t-att-class="{o_focused: state.focusedIndex === app_index}"
                               t-att-data-menu-xmlid="app.xmlid"
                               t-att-href="app.href || ('#menu_id='+app.id+'&amp;action_id='+app.actionID)"
                               t-on-click.prevent="() => this._onAppClick(app)"
                               t-key="app.id"
                               draggable="true"
                               t-on-dragstart="(e)=>this.dragStart(e)"
                               t-on-drop="(e)=>this.dropped(e)"
                               t-on-dragenter="(e)=>this.cancelDefault(e)"
                               t-on-dragover="(e)=>this.cancelDefault(e)">
                                <img t-if="app.webIconData"
                                     t-att-id="app.id"
                                     class="o_app_icon rounded"
                                     t-attf-src="{{app.webIconData}}"/>
                                <div t-else=""
                                     t-att-id="app.id"
                                     class="o_app_icon rounded d-flex p-2 justify-content-center align-items-center"
                                     t-attf-style="background-color: {{app.webIcon.backgroundColor}};">
                                    <i t-att-class="app.webIcon.iconClass"
                                       t-att-id="app.id"
                                       t-attf-style="color: {{app.webIcon.color}};"/>
                                </div>
                                <div class="o_caption w-100 text-center text-truncate mt-2"
                                     t-att-id="app.id"
                                     t-esc="app.label or app.name"/>
                            </a>
                        </t>
                    </div>
                    <t t-if="appCategory">
                        <t t-foreach="appCategory" t-as="category"
                           t-key="category.name">
                            <div role="listbox"
                                 class="o_apps row user-select-none accordion-collapse collapse app-data"
                                 style="max-height:10%;"
                                 data-bs-parent="#accordion"
                                 t-att-id="category.name">
                                <t t-if="!category.installed_apps.length">
                                    <div id="no_apps_in_category"
                                         style="margin-top: 25%;margin-left: 36%;font-size: xxx-large;"
                                         role="option" aria-selected="true"
                                         class="o_no_result">
                                        No Apps
                                    </div>
                                </t>
                                <t t-foreach="displayedApps" t-as="app"
                                   t-key="app.id">
                                    <t t-foreach="category.installed_apps"
                                       t-as="id" t-key="id">
                                        <t t-if="app.id == id">
                                            <a t-att-id="app.id"
                                               style="display:flex;flex-wrap:inherit;justify-content:center;"
                                               role="option"
                                               draggable="true"
                                               t-on-dragstart="(e)=>this.dragStart(e)"
                                               t-on-drop="(e)=>this.dropped(e)"
                                               t-on-dragenter="(e)=>this.cancelDefault(e)"
                                               t-on-dragover="(e)=>this.cancelDefault(e)"
                                               t-att-name="category.name"
                                               t-att-aria-selected="state.focusedIndex === app_index ? 'true' : 'false'"
                                               class="o_app o_menuitem p-2 mb-3 col-lg-2"
                                               t-att-class="{o_focused: state.focusedIndex === app_index}"
                                               t-att-data-menu-xmlid="app.xmlid"
                                               t-att-href="app.href || ('#menu_id='+app.id+'&amp;action_id='+app.actionID)"
                                               t-key="app.id"
                                               t-on-click.prevent="() => this._onAppClick(app)">
                                                <img t-if="app.webIconData"
                                                     t-att-id="app.id"
                                                     class="o_app_icon rounded"
                                                     t-attf-src="{{app.webIconData}}"/>
                                                <div t-else=""
                                                     t-att-id="app.id"
                                                     class="o_app_icon rounded d-flex p-2 justify-content-center align-items-center"
                                                     t-attf-style="background-color: {{app.webIcon.backgroundColor}};">
                                                    <i t-att-class="app.webIcon.iconClass"
                                                       t-att-id="app.id"
                                                       t-attf-style="color: {{app.webIcon.color}};"/>
                                                </div>
                                                <div class="o_caption w-100 text-center text-truncate mt-2"
                                                     t-att-id="app.id"
                                                     t-esc="app.label or app.name"/>
                                            </a>
                                        </t>
                                    </t>
                                </t>
                            </div>
                        </t>
                    </t>
                </div>
            </div>
            <div t-elif="!displayedApps.length" id="result_menu_0"
                 role="option"
                 aria-selected="true" class="o_no_result">
                No result
            </div>
        </xpath>
    </t>
</templates>
